<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ø§Ù… Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&display=swap');
        
        * {
            font-family: 'Tajawal', sans-serif;
        }
        
        body {
            box-sizing: border-box;
            background: linear-gradient(135deg, #B8860B 0%, #556B2F 50%, #2F4F4F 100%);
            background-attachment: fixed;
            min-height: 100vh;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(184, 134, 11, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(85, 107, 47, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(47, 79, 79, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.25);
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            border-radius: 20px;
        }

        .gold-gradient {
            background: linear-gradient(135deg, #B8860B 0%, #DAA520 100%);
        }

        .olive-gradient {
            background: linear-gradient(135deg, #556B2F 0%, #6B8E23 100%);
        }

        .dark-slate-gradient {
            background: linear-gradient(135deg, #2F4F4F 0%, #708090 100%);
        }

        .btn-primary {
            background: linear-gradient(135deg, #B8860B 0%, #DAA520 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(184, 134, 11, 0.3);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #DAA520 0%, #B8860B 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(184, 134, 11, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #556B2F 0%, #6B8E23 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(85, 107, 47, 0.3);
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, #6B8E23 0%, #556B2F 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(85, 107, 47, 0.4);
        }

        .form-input {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(184, 134, 11, 0.3);
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 16px;
            transition: all 0.3s ease;
            width: 100%;
        }

        .form-input:focus {
            outline: none;
            border-color: #B8860B;
            box-shadow: 0 0 0 3px rgba(184, 134, 11, 0.2);
            background: rgba(255, 255, 255, 1);
        }

        .status-ready {
            background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
            color: white;
        }

        .status-waiting {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            color: white;
        }

        .status-contact {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            color: white;
        }

        .task-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-left: 6px solid #B8860B;
            transition: all 0.3s ease;
        }

        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .signature-canvas {
            border: 2px dashed #B8860B;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.9);
            cursor: crosshair;
        }

        .nav-tab {
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.8);
            border: none;
            padding: 16px 32px;
            border-radius: 12px 12px 0 0;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-left: 4px;
        }

        .nav-tab.active {
            background: rgba(255, 255, 255, 0.95);
            color: #2F4F4F;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .print-area {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .print-area, .print-area * {
                visibility: visible;
            }
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                box-shadow: none;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .location-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 2px;
        }

        .location-B { background: #FF6B6B; color: white; }
        .location-G { background: #4ECDC4; color: white; }
        .location-M { background: #45B7D1; color: white; }
        .location-P { background: #96CEB4; color: white; }
        .location-E { background: #FFEAA7; color: #2d3436; }
        .location-K { background: #DDA0DD; color: white; }
        .location-T { background: #98D8C8; color: white; }
        .location-R { background: #F7DC6F; color: #2d3436; }

        .user-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-left: 6px solid #556B2F;
            transition: all 0.3s ease;
        }

        .user-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .priority-high {
            background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
            color: white;
        }

        .priority-medium {
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            color: white;
        }

        .priority-low {
            background: linear-gradient(135deg, #22C55E 0%, #16A34A 100%);
            color: white;
        }

        .assignment-task-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #B8860B;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .assignment-task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .assignment-task-card.selected {
            border-left-color: #556B2F;
            background: rgba(85, 107, 47, 0.1);
        }

        .specialization-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin: 2px;
            background: linear-gradient(135deg, #B8860B 0%, #DAA520 100%);
            color: white;
        }

        .department-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            margin: 2px;
        }

        .dept-maintenance { background: #3B82F6; color: white; }
        .dept-technical-support { background: #10B981; color: white; }
        .dept-network { background: #8B5CF6; color: white; }
        .dept-systems { background: #F59E0B; color: white; }
        .dept-admin { background: #EF4444; color: white; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="glass-effect text-white shadow-2xl mb-8">
        <div class="container mx-auto px-6 py-6">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <h1 class="text-3xl font-bold">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ø§Ù… Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h1>
                    <div class="gold-gradient px-4 py-2 rounded-full text-sm font-semibold">
                        Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
                    </div>
                </div>
                <div class="text-lg font-medium" id="current-time"></div>
            </div>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <div class="container mx-auto px-6 mb-8">
        <div class="flex">
            <button class="nav-tab active" onclick="showSection('reception')">
                ğŸ“¥ Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„
            </button>
            <button class="nav-tab" onclick="showSection('execution')">
                âš™ï¸ Ø´Ø§Ø´Ø© Ø§Ù„ØªÙ†ÙÙŠØ°
            </button>
            <button class="nav-tab" onclick="showSection('completed')">
                âœ… Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©
            </button>
            <button class="nav-tab" onclick="showSection('reports')">
                ğŸ“Š Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
            </button>
            <button class="nav-tab" onclick="showSection('users')">
                ğŸ‘¥ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            </button>
            <button class="nav-tab" onclick="showSection('assignment')">
                ğŸ“‹ ØªØ®ØµÙŠØµ Ø§Ù„Ù…Ù‡Ø§Ù…
            </button>
        </div>
    </div>

    <div class="container mx-auto px-6">
        <!-- Reception Section -->
        <section id="reception-section" class="section">
            <div class="glass-effect p-8 rounded-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3">ğŸ“¥</span>
                    Ø´Ø§Ø´Ø© Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                </h2>

                <form id="reception-form" class="space-y-6">
                    <!-- Device Information -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div>
                            <label class="block text-white font-semibold mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
                            <select id="device-type" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</option>
                                <option value="computer">Ø­Ø§Ø³Ø¨ Ø¢Ù„ÙŠ</option>
                                <option value="printer">Ø·Ø§Ø¨Ø¹Ø©</option>
                                <option value="scanner">Ù…Ø§Ø³Ø­ Ø¶ÙˆØ¦ÙŠ</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</label>
                            <select id="usage-type" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</option>
                                <option value="private">Ø®Ø§Øµ</option>
                                <option value="lab">Ù…Ø¹Ù…Ù„</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">Ø§Ù„Ø·Ø±Ø§Ø²</label>
                            <input type="text" id="device-model" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø·Ø±Ø§Ø² Ø§Ù„Ø¬Ù‡Ø§Ø²" required>
                        </div>
                    </div>

                    <!-- Technician Information -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-white font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</label>
                            <select id="receiving-technician" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-white font-semibold mb-2">ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</label>
                            <input type="datetime-local" id="receive-datetime" class="form-input" required>
                        </div>
                    </div>

                    <!-- Technical Requirements -->
                    <div class="glass-effect p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-white mb-4">Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ù†ÙØ°</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ù†ÙˆØ¹ Ø§Ù„ÙÙˆØ±Ù…Ø§Øª</label>
                                <select id="format-type" class="form-input">
                                    <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙÙˆØ±Ù…Ø§Øª</option>
                                    <option value="full">ÙÙˆØ±Ù…Ø§Øª ÙƒØ§Ù…Ù„</option>
                                    <option value="quick">ÙÙˆØ±Ù…Ø§Øª Ø³Ø±ÙŠØ¹</option>
                                    <option value="none">Ø¨Ø¯ÙˆÙ† ÙÙˆØ±Ù…Ø§Øª</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©</label>
                                <select id="language" class="form-input">
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©</option>
                                    <option value="arabic">Ø¹Ø±Ø¨ÙŠ</option>
                                    <option value="english">Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</option>
                                    <option value="both">Ø¹Ø±Ø¨ÙŠ + Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ</option>
                                </select>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="block text-white font-semibold mb-2">Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‡Ù…Ø©ØŸ</label>
                            <div class="flex space-x-4 space-x-reverse">
                                <label class="flex items-center text-white">
                                    <input type="radio" name="has-data" value="yes" class="ml-2">
                                    Ù†Ø¹Ù…ØŒ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª
                                </label>
                                <label class="flex items-center text-white">
                                    <input type="radio" name="has-data" value="no" class="ml-2">
                                    Ù„Ø§ØŒ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª
                                </label>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="block text-white font-semibold mb-2">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</label>
                            <div class="flex items-center space-x-4 space-x-reverse">
                                <select id="technician-signature" class="form-input flex-1">
                                    <option value="">Ø§Ø®ØªØ± ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠ</option>
                                </select>
                                <button type="button" onclick="openSignatureModal()" class="btn-secondary">
                                    Ø¥Ø¶Ø§ÙØ© ØªÙˆÙ‚ÙŠØ¹ Ø¬Ø¯ÙŠØ¯
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Beneficiary Information -->
                    <div class="glass-effect p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-white mb-4">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙÙŠØ¯ ØµØ§Ø­Ø¨ Ø§Ù„Ø¬Ù‡Ø§Ø²</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</label>
                                <input type="text" id="beneficiary-name" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙÙŠØ¯" required>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø³ÙˆØ¨</label>
                                <input type="text" id="employee-number" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø³ÙˆØ¨" required>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ùˆ Ø§Ù„ÙƒÙ„ÙŠØ©</label>
                                <input type="text" id="department" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£Ùˆ Ø§Ù„ÙƒÙ„ÙŠØ©" required>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø±Ù…Ø² Ø§Ù„Ù…Ù‚Ø±</label>
                                <select id="location-code" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ø±Ù…Ø² Ø§Ù„Ù…Ù‚Ø±</option>
                                    <option value="B">B - Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</option>
                                    <option value="G">G - Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ</option>
                                    <option value="M">M - Ø§Ù„Ù…Ø¹Ø§Ù…Ù„</option>
                                    <option value="P">P - Ù…ÙˆØ§Ù‚Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</option>
                                    <option value="E">E - ÙƒÙ„ÙŠØ© Ø§Ù„Ù‡Ù†Ø¯Ø³Ø©</option>
                                    <option value="K">K - ÙƒÙ„ÙŠØ© Ø§Ù„Ø·Ø¨</option>
                                    <option value="T">T - ÙƒÙ„ÙŠØ© Ø§Ù„ØªÙ‚Ù†ÙŠØ©</option>
                                    <option value="R">R - Ù…Ø±ÙƒØ² Ø§Ù„Ø£Ø¨Ø­Ø§Ø«</option>
                                </select>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="block text-white font-semibold mb-2">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</label>
                            <input type="tel" id="contact-number" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„" required>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="flex justify-center space-x-4 space-x-reverse mt-8">
                        <button type="button" onclick="printReceptionForm()" class="btn-secondary">
                            ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                        </button>
                        <button type="submit" class="btn-primary">
                            ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„ØªÙ†ÙÙŠØ°
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Execution Section -->
        <section id="execution-section" class="section hidden">
            <div class="glass-effect p-8 rounded-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3">âš™ï¸</span>
                    Ø´Ø§Ø´Ø© Ø§Ù„ØªÙ†ÙÙŠØ° - Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ ØªÙ†ÙÙŠØ°Ù‡Ø§
                </h2>

                <div id="pending-tasks" class="space-y-4 mb-8">
                    <!-- Pending tasks will be populated here -->
                </div>

                <!-- Status Update Form -->
                <div id="status-update-form" class="glass-effect p-6 rounded-xl hidden">
                    <h3 class="text-xl font-bold text-white mb-4">ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ù…Ø©</h3>
                    
                    <form id="execution-form">
                        <input type="hidden" id="task-id">
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ù†ÙØ°</label>
                                <select id="executing-technician" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ù†ÙØ°</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">ØªØ§Ø±ÙŠØ® ÙˆÙˆÙ‚Øª Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                                <input type="datetime-local" id="execution-datetime" class="form-input" required>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="block text-white font-semibold mb-2">Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†ÙÙŠØ°</label>
                            <select id="execution-status" class="form-input" required onchange="toggleReasonField()">
                                <option value="">Ø§Ø®ØªØ± Ø­Ø§Ù„Ø© Ø§Ù„ØªÙ†ÙÙŠØ°</option>
                                <option value="ready">Ø¬Ø§Ù‡Ø²</option>
                                <option value="waiting">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                                <option value="contact">Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</option>
                            </select>
                        </div>

                        <div id="reason-field" class="mt-4 hidden">
                            <label class="block text-white font-semibold mb-2">Ø§Ù„Ø³Ø¨Ø¨</label>
                            <textarea id="reason" class="form-input" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¨Ø¨"></textarea>
                        </div>

                        <div class="mt-4">
                            <label class="block text-white font-semibold mb-2">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ù†ÙØ°</label>
                            <select id="execution-signature" class="form-input" required>
                                <option value="">Ø§Ø®ØªØ± ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠ</option>
                            </select>
                        </div>

                        <div class="flex justify-center space-x-4 space-x-reverse mt-6">
                            <button type="button" onclick="cancelStatusUpdate()" class="btn-secondary">
                                Ø¥Ù„ØºØ§Ø¡
                            </button>
                            <button type="submit" class="btn-primary">
                                ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Completed Tasks Section -->
        <section id="completed-section" class="section hidden">
            <div class="glass-effect p-8 rounded-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3">âœ…</span>
                    Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†ØªÙ‡ÙŠØ©
                </h2>

                <div class="mb-6">
                    <div class="flex space-x-4 space-x-reverse">
                        <select id="status-filter" class="form-input max-w-xs" onchange="filterCompletedTasks()">
                            <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                            <option value="ready">Ø¬Ø§Ù‡Ø²</option>
                            <option value="waiting">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                            <option value="contact">Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</option>
                        </select>
                        <input type="date" id="date-filter" class="form-input max-w-xs" onchange="filterCompletedTasks()">
                    </div>
                </div>

                <div id="completed-tasks" class="space-y-4">
                    <!-- Completed tasks will be populated here -->
                </div>
            </div>
        </section>

        <!-- Users Management Section -->
        <section id="users-section" class="section hidden">
            <div class="glass-effect p-8 rounded-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3">ğŸ‘¥</span>
                    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆØ§Ù„ÙÙ†ÙŠÙŠÙ†
                </h2>

                <!-- Add New User Form -->
                <div class="glass-effect p-6 rounded-xl mb-8">
                    <h3 class="text-xl font-bold text-white mb-4">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯</h3>
                    
                    <form id="user-form" class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                                <input type="text" id="user-name" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" required>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ù„Ù‚Ø³Ù…</label>
                                <select id="user-department" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø³Ù…</option>
                                    <option value="maintenance">Ø§Ù„ØµÙŠØ§Ù†Ø©</option>
                                    <option value="technical-support">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</option>
                                    <option value="network">Ø§Ù„Ø´Ø¨ÙƒØ§Øª</option>
                                    <option value="systems">Ø§Ù„Ø£Ù†Ø¸Ù…Ø©</option>
                                    <option value="admin">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ù„Ù…Ù†ØµØ¨</label>
                                <select id="user-position" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØµØ¨</option>
                                    <option value="technician">ÙÙ†ÙŠ</option>
                                    <option value="senior-technician">ÙÙ†ÙŠ Ø£ÙˆÙ„</option>
                                    <option value="supervisor">Ù…Ø´Ø±Ù</option>
                                    <option value="manager">Ù…Ø¯ÙŠØ±</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                                <input type="tel" id="user-phone" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" required>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                                <input type="email" id="user-email" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
                            </div>
                        </div>

                        <div>
                            <label class="block text-white font-semibold mb-2">Ø§Ù„ØªØ®ØµØµØ§Øª</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                                <label class="flex items-center text-white">
                                    <input type="checkbox" name="specializations" value="hardware" class="ml-2">
                                    ØµÙŠØ§Ù†Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©
                                </label>
                                <label class="flex items-center text-white">
                                    <input type="checkbox" name="specializations" value="software" class="ml-2">
                                    Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª
                                </label>
                                <label class="flex items-center text-white">
                                    <input type="checkbox" name="specializations" value="network" class="ml-2">
                                    Ø§Ù„Ø´Ø¨ÙƒØ§Øª
                                </label>
                                <label class="flex items-center text-white">
                                    <input type="checkbox" name="specializations" value="printers" class="ml-2">
                                    Ø§Ù„Ø·Ø§Ø¨Ø¹Ø§Øª
                                </label>
                            </div>
                        </div>

                        <div class="flex justify-center">
                            <button type="submit" class="btn-primary">
                                â• Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Users List -->
                <div class="glass-effect p-6 rounded-xl">
                    <h3 class="text-xl font-bold text-white mb-4">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                    
                    <div class="mb-4">
                        <div class="flex space-x-4 space-x-reverse">
                            <select id="department-filter" class="form-input max-w-xs" onchange="filterUsers()">
                                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</option>
                                <option value="maintenance">Ø§Ù„ØµÙŠØ§Ù†Ø©</option>
                                <option value="technical-support">Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</option>
                                <option value="network">Ø§Ù„Ø´Ø¨ÙƒØ§Øª</option>
                                <option value="systems">Ø§Ù„Ø£Ù†Ø¸Ù…Ø©</option>
                                <option value="admin">Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</option>
                            </select>
                            <input type="text" id="search-users" class="form-input max-w-xs" placeholder="Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³ØªØ®Ø¯Ù…..." onkeyup="filterUsers()">
                        </div>
                    </div>

                    <div id="users-list" class="space-y-4">
                        <!-- Users will be populated here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Task Assignment Section -->
        <section id="assignment-section" class="section hidden">
            <div class="glass-effect p-8 rounded-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3">ğŸ“‹</span>
                    ØªØ®ØµÙŠØµ ÙˆØ¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù…
                </h2>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Task Details -->
                    <div class="glass-effect p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-white mb-4">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</h3>
                        
                        <div id="task-details-container">
                            <div class="text-center py-12">
                                <div class="text-6xl mb-4">ğŸ“‹</div>
                                <h3 class="text-xl font-bold text-white mb-2">Ø§Ø®ØªØ± Ù…Ù‡Ù…Ø© Ù„Ù„ØªØ®ØµÙŠØµ</h3>
                                <p class="text-white opacity-80">Ø­Ø¯Ø¯ Ù…Ù‡Ù…Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„Ù‡Ø§</p>
                            </div>
                        </div>
                    </div>

                    <!-- Available Tasks -->
                    <div class="glass-effect p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-white mb-4">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ØªØ§Ø­Ø© Ù„Ù„ØªØ®ØµÙŠØµ</h3>
                        
                        <div class="mb-4">
                            <select id="task-priority-filter" class="form-input" onchange="filterAssignmentTasks()">
                                <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</option>
                                <option value="high">Ø¹Ø§Ù„ÙŠØ©</option>
                                <option value="medium">Ù…ØªÙˆØ³Ø·Ø©</option>
                                <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
                            </select>
                        </div>

                        <div id="assignment-tasks-list" class="space-y-4 max-h-96 overflow-y-auto">
                            <!-- Tasks will be populated here -->
                        </div>
                    </div>
                </div>

                <!-- Assignment Form -->
                <div id="assignment-form-container" class="glass-effect p-6 rounded-xl mt-8 hidden">
                    <h3 class="text-xl font-bold text-white mb-4">Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ù…Ù‡Ù…Ø©</h3>
                    
                    <form id="assignment-form">
                        <input type="hidden" id="assign-task-id">
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø®ØªØµ</label>
                                <select id="assigned-technician" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†ÙŠ</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù…Ù‡Ù…Ø©</label>
                                <select id="task-priority" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</option>
                                    <option value="high">Ø¹Ø§Ù„ÙŠØ©</option>
                                    <option value="medium">Ù…ØªÙˆØ³Ø·Ø©</option>
                                    <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                            <div>
                                <label class="block text-white font-semibold mb-2">Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ù„Ù„Ø¥Ù†Ø¬Ø§Ø²</label>
                                <input type="datetime-local" id="expected-completion" class="form-input" required>
                            </div>
                            <div>
                                <label class="block text-white font-semibold mb-2">Ù†ÙˆØ¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</label>
                                <select id="maintenance-type" class="form-input" required>
                                    <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ØµÙŠØ§Ù†Ø©</option>
                                    <option value="preventive">ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ©</option>
                                    <option value="corrective">ØµÙŠØ§Ù†Ø© Ø¥ØµÙ„Ø§Ø­ÙŠØ©</option>
                                    <option value="emergency">ØµÙŠØ§Ù†Ø© Ø·Ø§Ø±Ø¦Ø©</option>
                                    <option value="upgrade">ØªØ±Ù‚ÙŠØ©</option>
                                </select>
                            </div>
                        </div>

                        <div class="mt-4">
                            <label class="block text-white font-semibold mb-2">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø®Ø§ØµØ©</label>
                            <textarea id="assignment-notes" class="form-input" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ùˆ ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø®Ø§ØµØ© Ù„Ù„ÙÙ†ÙŠ"></textarea>
                        </div>

                        <div class="flex justify-center space-x-4 space-x-reverse mt-6">
                            <button type="button" onclick="cancelAssignment()" class="btn-secondary">
                                Ø¥Ù„ØºØ§Ø¡
                            </button>
                            <button type="submit" class="btn-primary">
                                ğŸ“¤ Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ù…Ù‡Ù…Ø©
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports-section" class="section hidden">
            <div class="glass-effect p-8 rounded-2xl">
                <h2 class="text-2xl font-bold text-white mb-6 flex items-center">
                    <span class="text-3xl ml-3">ğŸ“Š</span>
                    Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                </h2>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="glass-effect p-6 rounded-xl text-center">
                        <div class="text-3xl mb-2">ğŸ“¥</div>
                        <div class="text-2xl font-bold text-white" id="total-received">0</div>
                        <div class="text-white opacity-80">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</div>
                    </div>
                    <div class="glass-effect p-6 rounded-xl text-center">
                        <div class="text-3xl mb-2">âš™ï¸</div>
                        <div class="text-2xl font-bold text-white" id="total-pending">0</div>
                        <div class="text-white opacity-80">Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</div>
                    </div>
                    <div class="glass-effect p-6 rounded-xl text-center">
                        <div class="text-3xl mb-2">âœ…</div>
                        <div class="text-2xl font-bold text-white" id="total-completed">0</div>
                        <div class="text-white opacity-80">Ù…ÙƒØªÙ…Ù„</div>
                    </div>
                    <div class="glass-effect p-6 rounded-xl text-center">
                        <div class="text-3xl mb-2">ğŸ‘¥</div>
                        <div class="text-2xl font-bold text-white" id="total-technicians">0</div>
                        <div class="text-white opacity-80">Ø§Ù„ÙÙ†ÙŠÙŠÙ†</div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div class="glass-effect p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-white mb-4">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©</h3>
                        <div id="device-distribution" class="space-y-3">
                            <!-- Device distribution will be populated here -->
                        </div>
                    </div>
                    <div class="glass-effect p-6 rounded-xl">
                        <h3 class="text-xl font-bold text-white mb-4">ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…Ù‚Ø±Ø§Øª</h3>
                        <div id="location-distribution" class="space-y-3">
                            <!-- Location distribution will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Signature Modal -->
    <div id="signature-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4">
            <h3 class="text-2xl font-bold mb-4 text-center">Ø¥Ø¶Ø§ÙØ© ØªÙˆÙ‚ÙŠØ¹ Ø¬Ø¯ÙŠØ¯</h3>
            
            <div class="mb-4">
                <label class="block font-semibold mb-2">Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ</label>
                <input type="text" id="signature-name" class="form-input" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ">
            </div>
            
            <div class="mb-4">
                <label class="block font-semibold mb-2">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</label>
                <canvas id="signature-canvas" class="signature-canvas w-full h-32"></canvas>
            </div>
            
            <div class="flex justify-center space-x-4 space-x-reverse">
                <button onclick="clearSignature()" class="btn-secondary">Ù…Ø³Ø­</button>
                <button onclick="saveSignature()" class="btn-primary">Ø­ÙØ¸</button>
                <button onclick="closeSignatureModal()" class="btn-secondary">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <!-- Print Area -->
    <div id="print-area" class="print-area hidden">
        <!-- Print content will be populated here -->
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <span id="notification-text"></span>
    </div>

    <script>
        // Data Management System
        const MaintenanceSystem = {
            tasks: JSON.parse(localStorage.getItem('maintenance_tasks') || '[]'),
            technicians: JSON.parse(localStorage.getItem('technicians') || '[]'),
            signatures: JSON.parse(localStorage.getItem('signatures') || '{}'),
            users: JSON.parse(localStorage.getItem('users') || '[]'),
            
            saveData() {
                localStorage.setItem('maintenance_tasks', JSON.stringify(this.tasks));
                localStorage.setItem('technicians', JSON.stringify(this.technicians));
                localStorage.setItem('signatures', JSON.stringify(this.signatures));
                localStorage.setItem('users', JSON.stringify(this.users));
            },
            
            generateId() {
                return Date.now().toString() + Math.random().toString(36).substr(2, 9);
            },
            
            addTask(taskData) {
                const task = {
                    id: this.generateId(),
                    ...taskData,
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };
                this.tasks.push(task);
                this.saveData();
                return task;
            },
            
            updateTaskStatus(taskId, statusData) {
                const taskIndex = this.tasks.findIndex(task => task.id === taskId);
                if (taskIndex !== -1) {
                    this.tasks[taskIndex] = {
                        ...this.tasks[taskIndex],
                        ...statusData,
                        status: 'completed',
                        completedAt: new Date().toISOString()
                    };
                    this.saveData();
                    return this.tasks[taskIndex];
                }
                return null;
            },
            
            getPendingTasks() {
                return this.tasks.filter(task => task.status === 'pending');
            },
            
            getCompletedTasks() {
                return this.tasks.filter(task => task.status === 'completed');
            },

            addUser(userData) {
                const user = {
                    id: this.generateId(),
                    ...userData,
                    createdAt: new Date().toISOString()
                };
                this.users.push(user);
                this.saveData();
                return user;
            },

            updateUser(userId, userData) {
                const userIndex = this.users.findIndex(user => user.id === userId);
                if (userIndex !== -1) {
                    this.users[userIndex] = {
                        ...this.users[userIndex],
                        ...userData,
                        updatedAt: new Date().toISOString()
                    };
                    this.saveData();
                    return this.users[userIndex];
                }
                return null;
            },

            deleteUser(userId) {
                const userIndex = this.users.findIndex(user => user.id === userId);
                if (userIndex !== -1) {
                    this.users.splice(userIndex, 1);
                    this.saveData();
                    return true;
                }
                return false;
            },

            assignTask(taskId, assignmentData) {
                const taskIndex = this.tasks.findIndex(task => task.id === taskId);
                if (taskIndex !== -1) {
                    this.tasks[taskIndex] = {
                        ...this.tasks[taskIndex],
                        ...assignmentData,
                        status: 'assigned',
                        assignedAt: new Date().toISOString()
                    };
                    this.saveData();
                    return this.tasks[taskIndex];
                }
                return null;
            },

            getUnassignedTasks() {
                return this.tasks.filter(task => task.status === 'pending');
            },

            getAssignedTasks() {
                return this.tasks.filter(task => task.status === 'assigned');
            }
        };

        // Initialize default technicians if empty
        if (MaintenanceSystem.technicians.length === 0) {
            MaintenanceSystem.technicians = [
                { id: '1', name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø£Ø­Ù…Ø¯', department: 'Ø§Ù„ØµÙŠØ§Ù†Ø©' },
                { id: '2', name: 'Ù…Ø­Ù…Ø¯ Ø³Ø§Ù„Ù… Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ', department: 'Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ' },
                { id: '3', name: 'Ø®Ø§Ù„Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ', department: 'Ø§Ù„ØµÙŠØ§Ù†Ø©' },
                { id: '4', name: 'Ø³Ø¹Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ', department: 'Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ' },
                { id: '5', name: 'Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† Ø­Ø³Ù† Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ', department: 'Ø§Ù„ØµÙŠØ§Ù†Ø©' }
            ];
            MaintenanceSystem.saveData();
        }

        // Signature Canvas Setup
        let signatureCanvas, signatureCtx, isDrawing = false;

        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            updateTime();
            setInterval(updateTime, 1000);
            
            // Set current datetime
            document.getElementById('receive-datetime').value = new Date().toISOString().slice(0, 16);
            document.getElementById('execution-datetime').value = new Date().toISOString().slice(0, 16);
            
            // Form handlers
            document.getElementById('reception-form').addEventListener('submit', handleReceptionSubmit);
            document.getElementById('execution-form').addEventListener('submit', handleExecutionSubmit);
            document.getElementById('user-form').addEventListener('submit', handleUserSubmit);
            document.getElementById('assignment-form').addEventListener('submit', handleAssignmentSubmit);
            
            setupSignatureCanvas();
        });

        function initializeApp() {
            populateTechniciansDropdowns();
            populateSignaturesDropdowns();
            renderPendingTasks();
            renderCompletedTasks();
            renderUsersList();
            renderAssignmentTasks();
            updateReports();
        }

        function updateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            const timeString = now.toLocaleDateString('ar-SA', options);
            document.getElementById('current-time').textContent = timeString;
        }

        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(sectionName + '-section').classList.remove('hidden');
            
            // Update navigation
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update section-specific data
            if (sectionName === 'execution') {
                renderPendingTasks();
            } else if (sectionName === 'completed') {
                renderCompletedTasks();
            } else if (sectionName === 'reports') {
                updateReports();
            } else if (sectionName === 'users') {
                renderUsersList();
            } else if (sectionName === 'assignment') {
                renderAssignmentTasks();
                populateAssignmentTechnicians();
            }
        }

        function populateTechniciansDropdowns() {
            const dropdowns = ['receiving-technician', 'executing-technician'];
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†ÙŠ</option>' +
                    MaintenanceSystem.technicians.map(tech => 
                        `<option value="${tech.id}">${tech.name} - ${tech.department}</option>`
                    ).join('');
            });
        }

        function populateSignaturesDropdowns() {
            const dropdowns = ['technician-signature', 'execution-signature'];
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</option>' +
                    Object.keys(MaintenanceSystem.signatures).map(name => 
                        `<option value="${name}">${name}</option>`
                    ).join('');
            });
        }

        function handleReceptionSubmit(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const hasDataRadio = document.querySelector('input[name="has-data"]:checked');
            
            const taskData = {
                deviceType: document.getElementById('device-type').value,
                usageType: document.getElementById('usage-type').value,
                deviceModel: document.getElementById('device-model').value,
                receivingTechnician: document.getElementById('receiving-technician').value,
                receiveDateTime: document.getElementById('receive-datetime').value,
                formatType: document.getElementById('format-type').value,
                language: document.getElementById('language').value,
                hasData: hasDataRadio ? hasDataRadio.value : '',
                technicianSignature: document.getElementById('technician-signature').value,
                beneficiaryName: document.getElementById('beneficiary-name').value,
                employeeNumber: document.getElementById('employee-number').value,
                department: document.getElementById('department').value,
                locationCode: document.getElementById('location-code').value,
                contactNumber: document.getElementById('contact-number').value
            };
            
            const task = MaintenanceSystem.addTask(taskData);
            
            showNotification('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¥Ù„Ù‰ Ù‚Ø³Ù… Ø§Ù„ØªÙ†ÙÙŠØ° Ø¨Ù†Ø¬Ø§Ø­!');
            e.target.reset();
            document.getElementById('receive-datetime').value = new Date().toISOString().slice(0, 16);
            
            renderPendingTasks();
            updateReports();
        }

        function renderPendingTasks() {
            const container = document.getElementById('pending-tasks');
            const pendingTasks = MaintenanceSystem.getPendingTasks();
            
            if (pendingTasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ğŸ“‹</div>
                        <h3 class="text-2xl font-bold text-white mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°</h3>
                        <p class="text-white opacity-80">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ù…ÙƒØªÙ…Ù„Ø©</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = pendingTasks.map(task => {
                const technician = MaintenanceSystem.technicians.find(t => t.id === task.receivingTechnician);
                return `
                    <div class="task-card">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2">
                                    ${getDeviceTypeText(task.deviceType)} - ${task.deviceModel}
                                </h3>
                                <p class="text-gray-600">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯: ${task.beneficiaryName} (${task.employeeNumber})</p>
                                <p class="text-gray-600">Ø§Ù„Ù‚Ø³Ù…: ${task.department}</p>
                            </div>
                            <div class="text-left">
                                <span class="location-badge location-${task.locationCode}">${task.locationCode}</span>
                                <div class="text-sm text-gray-500 mt-2">
                                    ${new Date(task.receiveDateTime).toLocaleString('ar-SA')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm">
                            <div>
                                <span class="font-semibold">Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</span>
                                <div>${getUsageTypeText(task.usageType)}</div>
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„ÙÙˆØ±Ù…Ø§Øª:</span>
                                <div>${getFormatTypeText(task.formatType)}</div>
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„Ù„ØºØ©:</span>
                                <div>${getLanguageText(task.language)}</div>
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</span>
                                <div>${task.hasData === 'yes' ? 'ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'}</div>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center">
                            <div class="text-sm text-gray-600">
                                <span class="font-semibold">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…:</span> ${technician ? technician.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                            </div>
                            <div class="flex space-x-2 space-x-reverse">
                                <button onclick="updateTaskStatus('${task.id}')" class="btn-primary">
                                    ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø©
                                </button>
                                <button onclick="printTaskDetails('${task.id}')" class="btn-secondary">
                                    Ø·Ø¨Ø§Ø¹Ø©
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function updateTaskStatus(taskId) {
            document.getElementById('task-id').value = taskId;
            document.getElementById('status-update-form').classList.remove('hidden');
            document.getElementById('execution-datetime').value = new Date().toISOString().slice(0, 16);
        }

        function cancelStatusUpdate() {
            document.getElementById('status-update-form').classList.add('hidden');
            document.getElementById('execution-form').reset();
        }

        function toggleReasonField() {
            const status = document.getElementById('execution-status').value;
            const reasonField = document.getElementById('reason-field');
            
            if (status === 'waiting' || status === 'contact') {
                reasonField.classList.remove('hidden');
                document.getElementById('reason').required = true;
            } else {
                reasonField.classList.add('hidden');
                document.getElementById('reason').required = false;
            }
        }

        function handleExecutionSubmit(e) {
            e.preventDefault();
            
            const taskId = document.getElementById('task-id').value;
            const statusData = {
                executingTechnician: document.getElementById('executing-technician').value,
                executionDateTime: document.getElementById('execution-datetime').value,
                executionStatus: document.getElementById('execution-status').value,
                reason: document.getElementById('reason').value,
                executionSignature: document.getElementById('execution-signature').value
            };
            
            MaintenanceSystem.updateTaskStatus(taskId, statusData);
            
            showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!');
            
            cancelStatusUpdate();
            renderPendingTasks();
            renderCompletedTasks();
            updateReports();
        }

        function renderCompletedTasks() {
            const container = document.getElementById('completed-tasks');
            let completedTasks = MaintenanceSystem.getCompletedTasks();
            
            // Apply filters
            const statusFilter = document.getElementById('status-filter').value;
            const dateFilter = document.getElementById('date-filter').value;
            
            if (statusFilter) {
                completedTasks = completedTasks.filter(task => task.executionStatus === statusFilter);
            }
            
            if (dateFilter) {
                completedTasks = completedTasks.filter(task => 
                    task.executionDateTime.startsWith(dateFilter)
                );
            }
            
            if (completedTasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">âœ…</div>
                        <h3 class="text-2xl font-bold text-white mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù…ÙƒØªÙ…Ù„Ø©</h3>
                        <p class="text-white opacity-80">Ù„Ù… ÙŠØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø£ÙŠ Ù…Ù‡Ø§Ù… Ø¨Ø¹Ø¯</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = completedTasks.map(task => {
                const receivingTech = MaintenanceSystem.technicians.find(t => t.id === task.receivingTechnician);
                const executingTech = MaintenanceSystem.technicians.find(t => t.id === task.executingTechnician);
                
                return `
                    <div class="task-card">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="text-xl font-bold text-gray-800 mb-2">
                                    ${getDeviceTypeText(task.deviceType)} - ${task.deviceModel}
                                </h3>
                                <p class="text-gray-600">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯: ${task.beneficiaryName}</p>
                                <p class="text-gray-600">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„: ${task.contactNumber}</p>
                            </div>
                            <div class="text-left">
                                <span class="px-3 py-1 rounded-full text-sm font-semibold ${getStatusClass(task.executionStatus)}">
                                    ${getStatusText(task.executionStatus)}
                                </span>
                                <div class="text-sm text-gray-500 mt-2">
                                    ${new Date(task.executionDateTime).toLocaleString('ar-SA')}
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-4 text-sm">
                            <div>
                                <span class="font-semibold">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…:</span>
                                <div>${receivingTech ? receivingTech.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ù†ÙØ°:</span>
                                <div>${executingTech ? executingTech.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                            </div>
                        </div>
                        
                        ${task.reason ? `
                            <div class="mb-4 p-3 bg-yellow-50 rounded-lg">
                                <span class="font-semibold text-yellow-800">Ø§Ù„Ø³Ø¨Ø¨:</span>
                                <div class="text-yellow-700">${task.reason}</div>
                            </div>
                        ` : ''}
                        
                        <div class="flex justify-end">
                            <button onclick="printCompletionForm('${task.id}')" class="btn-primary">
                                ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ù„ÙŠÙ…
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function filterCompletedTasks() {
            renderCompletedTasks();
        }

        // User Management Functions
        function handleUserSubmit(e) {
            e.preventDefault();
            
            const specializations = Array.from(document.querySelectorAll('input[name="specializations"]:checked'))
                .map(checkbox => checkbox.value);
            
            const userData = {
                name: document.getElementById('user-name').value,
                department: document.getElementById('user-department').value,
                position: document.getElementById('user-position').value,
                phone: document.getElementById('user-phone').value,
                email: document.getElementById('user-email').value,
                specializations: specializations
            };
            
            MaintenanceSystem.addUser(userData);
            
            showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!');
            e.target.reset();
            
            renderUsersList();
            populateTechniciansDropdowns();
            populateAssignmentTechnicians();
            updateReports();
        }

        function renderUsersList() {
            const container = document.getElementById('users-list');
            let users = MaintenanceSystem.users;
            
            // Apply filters
            const departmentFilter = document.getElementById('department-filter').value;
            const searchTerm = document.getElementById('search-users').value.toLowerCase();
            
            if (departmentFilter) {
                users = users.filter(user => user.department === departmentFilter);
            }
            
            if (searchTerm) {
                users = users.filter(user => 
                    user.name.toLowerCase().includes(searchTerm) ||
                    user.phone.includes(searchTerm) ||
                    (user.email && user.email.toLowerCase().includes(searchTerm))
                );
            }
            
            if (users.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">ğŸ‘¥</div>
                        <h3 class="text-2xl font-bold text-white mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                        <p class="text-white opacity-80">Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø¨Ø¹Ø¯</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = users.map(user => `
                <div class="user-card">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-2">${user.name}</h3>
                            <div class="flex items-center space-x-2 space-x-reverse mb-2">
                                <span class="department-badge dept-${user.department}">
                                    ${getDepartmentText(user.department)}
                                </span>
                                <span class="text-gray-600">${getPositionText(user.position)}</span>
                            </div>
                        </div>
                        <div class="text-left">
                            <div class="text-sm text-gray-500">
                                ${new Date(user.createdAt).toLocaleDateString('ar-SA')}
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 text-sm">
                        <div>
                            <span class="font-semibold">Ø§Ù„Ù‡Ø§ØªÙ:</span>
                            <div>${user.phone}</div>
                        </div>
                        <div>
                            <span class="font-semibold">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</span>
                            <div>${user.email || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                        </div>
                    </div>
                    
                    ${user.specializations && user.specializations.length > 0 ? `
                        <div class="mb-4">
                            <span class="font-semibold text-sm">Ø§Ù„ØªØ®ØµØµØ§Øª:</span>
                            <div class="mt-2">
                                ${user.specializations.map(spec => 
                                    `<span class="specialization-badge">${getSpecializationText(spec)}</span>`
                                ).join('')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="flex justify-end space-x-2 space-x-reverse">
                        <button onclick="editUser('${user.id}')" class="btn-secondary text-sm">
                            ØªØ¹Ø¯ÙŠÙ„
                        </button>
                        <button onclick="deleteUser('${user.id}')" class="btn-primary text-sm bg-red-600 hover:bg-red-700">
                            Ø­Ø°Ù
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function filterUsers() {
            renderUsersList();
        }

        function editUser(userId) {
            const user = MaintenanceSystem.users.find(u => u.id === userId);
            if (!user) return;
            
            // Populate form with user data
            document.getElementById('user-name').value = user.name;
            document.getElementById('user-department').value = user.department;
            document.getElementById('user-position').value = user.position;
            document.getElementById('user-phone').value = user.phone;
            document.getElementById('user-email').value = user.email || '';
            
            // Set specializations
            document.querySelectorAll('input[name="specializations"]').forEach(checkbox => {
                checkbox.checked = user.specializations && user.specializations.includes(checkbox.value);
            });
            
            // Change form to edit mode
            const form = document.getElementById('user-form');
            form.dataset.editId = userId;
            form.querySelector('button[type="submit"]').textContent = 'ğŸ’¾ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…';
        }

        function deleteUser(userId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŸ')) {
                MaintenanceSystem.deleteUser(userId);
                showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!');
                renderUsersList();
                populateTechniciansDropdowns();
                populateAssignmentTechnicians();
                updateReports();
            }
        }

        // Task Assignment Functions
        function renderAssignmentTasks() {
            const container = document.getElementById('assignment-tasks-list');
            let tasks = MaintenanceSystem.getUnassignedTasks();
            
            // Apply priority filter
            const priorityFilter = document.getElementById('task-priority-filter').value;
            if (priorityFilter) {
                tasks = tasks.filter(task => task.priority === priorityFilter);
            }
            
            if (tasks.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-8">
                        <div class="text-4xl mb-2">ğŸ“‹</div>
                        <h3 class="text-lg font-bold text-white mb-2">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù„Ù„ØªØ®ØµÙŠØµ</h3>
                        <p class="text-white opacity-80 text-sm">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù… Ù…Ø®ØµØµØ© Ø£Ùˆ Ù…ÙƒØªÙ…Ù„Ø©</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = tasks.map(task => {
                const receivingTech = MaintenanceSystem.technicians.find(t => t.id === task.receivingTechnician);
                return `
                    <div class="assignment-task-card" onclick="selectTaskForAssignment('${task.id}')">
                        <div class="flex justify-between items-start mb-2">
                            <h4 class="font-bold text-gray-800">${getDeviceTypeText(task.deviceType)} - ${task.deviceModel}</h4>
                            <span class="location-badge location-${task.locationCode}">${task.locationCode}</span>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯: ${task.beneficiaryName}</p>
                        <p class="text-gray-600 text-sm mb-2">Ø§Ù„Ù‚Ø³Ù…: ${task.department}</p>
                        <div class="flex justify-between items-center text-xs text-gray-500">
                            <span>Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…: ${receivingTech ? receivingTech.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            <span>${new Date(task.receiveDateTime).toLocaleDateString('ar-SA')}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function selectTaskForAssignment(taskId) {
            // Remove previous selection
            document.querySelectorAll('.assignment-task-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // Add selection to clicked card
            event.target.closest('.assignment-task-card').classList.add('selected');
            
            // Show task details
            showTaskDetails(taskId);
            
            // Show assignment form
            document.getElementById('assignment-form-container').classList.remove('hidden');
            document.getElementById('assign-task-id').value = taskId;
            
            // Set default completion date (3 days from now)
            const defaultDate = new Date();
            defaultDate.setDate(defaultDate.getDate() + 3);
            document.getElementById('expected-completion').value = defaultDate.toISOString().slice(0, 16);
        }

        function showTaskDetails(taskId) {
            const task = MaintenanceSystem.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            const receivingTech = MaintenanceSystem.technicians.find(t => t.id === task.receivingTechnician);
            const container = document.getElementById('task-details-container');
            
            container.innerHTML = `
                <div class="bg-white rounded-lg p-6">
                    <h4 class="text-xl font-bold text-gray-800 mb-4">${getDeviceTypeText(task.deviceType)} - ${task.deviceModel}</h4>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                        <div>
                            <span class="font-semibold">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯:</span>
                            <div>${task.beneficiaryName}</div>
                        </div>
                        <div>
                            <span class="font-semibold">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø³ÙˆØ¨:</span>
                            <div>${task.employeeNumber}</div>
                        </div>
                        <div>
                            <span class="font-semibold">Ø§Ù„Ù‚Ø³Ù…:</span>
                            <div>${task.department}</div>
                        </div>
                        <div>
                            <span class="font-semibold">Ø§Ù„Ù…Ù‚Ø±:</span>
                            <div><span class="location-badge location-${task.locationCode}">${task.locationCode}</span></div>
                        </div>
                        <div>
                            <span class="font-semibold">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„:</span>
                            <div>${task.contactNumber}</div>
                        </div>
                        <div>
                            <span class="font-semibold">Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</span>
                            <div>${getUsageTypeText(task.usageType)}</div>
                        </div>
                    </div>
                    
                    <div class="border-t pt-4">
                        <h5 class="font-bold mb-2">Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„ÙÙ†ÙŠ:</h5>
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div>
                                <span class="font-semibold">Ø§Ù„ÙÙˆØ±Ù…Ø§Øª:</span> ${getFormatTypeText(task.formatType)}
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„Ù„ØºØ©:</span> ${getLanguageText(task.language)}
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</span> ${task.hasData === 'yes' ? 'ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'}
                            </div>
                            <div>
                                <span class="font-semibold">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…:</span> ${receivingTech ? receivingTech.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}
                            </div>
                        </div>
                    </div>
                    
                    <div class="border-t pt-4 mt-4">
                        <div class="text-sm text-gray-600">
                            <span class="font-semibold">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</span> ${new Date(task.receiveDateTime).toLocaleString('ar-SA')}
                        </div>
                    </div>
                </div>
            `;
        }

        function populateAssignmentTechnicians() {
            const dropdown = document.getElementById('assigned-technician');
            const allTechnicians = [...MaintenanceSystem.technicians, ...MaintenanceSystem.users];
            
            dropdown.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙÙ†ÙŠ</option>' +
                allTechnicians.map(tech => 
                    `<option value="${tech.id}">${tech.name} - ${tech.department || 'Ù‚Ø³Ù… ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</option>`
                ).join('');
        }

        function handleAssignmentSubmit(e) {
            e.preventDefault();
            
            const taskId = document.getElementById('assign-task-id').value;
            const assignmentData = {
                assignedTechnician: document.getElementById('assigned-technician').value,
                priority: document.getElementById('task-priority').value,
                expectedCompletion: document.getElementById('expected-completion').value,
                maintenanceType: document.getElementById('maintenance-type').value,
                assignmentNotes: document.getElementById('assignment-notes').value
            };
            
            MaintenanceSystem.assignTask(taskId, assignmentData);
            
            showNotification('ØªÙ… Ø¥Ø³Ù†Ø§Ø¯ Ø§Ù„Ù…Ù‡Ù…Ø© Ø¨Ù†Ø¬Ø§Ø­!');
            
            cancelAssignment();
            renderAssignmentTasks();
            renderPendingTasks();
            updateReports();
        }

        function cancelAssignment() {
            document.getElementById('assignment-form-container').classList.add('hidden');
            document.getElementById('assignment-form').reset();
            document.getElementById('task-details-container').innerHTML = `
                <div class="text-center py-12">
                    <div class="text-6xl mb-4">ğŸ“‹</div>
                    <h3 class="text-xl font-bold text-white mb-2">Ø§Ø®ØªØ± Ù…Ù‡Ù…Ø© Ù„Ù„ØªØ®ØµÙŠØµ</h3>
                    <p class="text-white opacity-80">Ø­Ø¯Ø¯ Ù…Ù‡Ù…Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„Ù‡Ø§</p>
                </div>
            `;
            
            // Remove selection
            document.querySelectorAll('.assignment-task-card').forEach(card => {
                card.classList.remove('selected');
            });
        }

        function filterAssignmentTasks() {
            renderAssignmentTasks();
        }

        function updateReports() {
            const totalReceived = MaintenanceSystem.tasks.length;
            const totalPending = MaintenanceSystem.getPendingTasks().length;
            const totalCompleted = MaintenanceSystem.getCompletedTasks().length;
            const totalTechnicians = MaintenanceSystem.technicians.length;
            
            document.getElementById('total-received').textContent = totalReceived;
            document.getElementById('total-pending').textContent = totalPending;
            document.getElementById('total-completed').textContent = totalCompleted;
            document.getElementById('total-technicians').textContent = totalTechnicians;
            
            // Device distribution
            const deviceCounts = {};
            MaintenanceSystem.tasks.forEach(task => {
                deviceCounts[task.deviceType] = (deviceCounts[task.deviceType] || 0) + 1;
            });
            
            const deviceContainer = document.getElementById('device-distribution');
            deviceContainer.innerHTML = Object.entries(deviceCounts).map(([type, count]) => `
                <div class="flex justify-between items-center text-white">
                    <span>${getDeviceTypeText(type)}</span>
                    <span class="font-bold">${count}</span>
                </div>
            `).join('');
            
            // Location distribution
            const locationCounts = {};
            MaintenanceSystem.tasks.forEach(task => {
                locationCounts[task.locationCode] = (locationCounts[task.locationCode] || 0) + 1;
            });
            
            const locationContainer = document.getElementById('location-distribution');
            locationContainer.innerHTML = Object.entries(locationCounts).map(([code, count]) => `
                <div class="flex justify-between items-center text-white">
                    <span class="location-badge location-${code}">${code}</span>
                    <span class="font-bold">${count}</span>
                </div>
            `).join('');
        }

        // Signature Management
        function setupSignatureCanvas() {
            signatureCanvas = document.getElementById('signature-canvas');
            signatureCtx = signatureCanvas.getContext('2d');
            
            signatureCanvas.addEventListener('mousedown', startDrawing);
            signatureCanvas.addEventListener('mousemove', draw);
            signatureCanvas.addEventListener('mouseup', stopDrawing);
            signatureCanvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for mobile
            signatureCanvas.addEventListener('touchstart', handleTouch);
            signatureCanvas.addEventListener('touchmove', handleTouch);
            signatureCanvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = signatureCanvas.getBoundingClientRect();
            signatureCtx.beginPath();
            signatureCtx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function draw(e) {
            if (!isDrawing) return;
            const rect = signatureCanvas.getBoundingClientRect();
            signatureCtx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            signatureCtx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                           e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            signatureCanvas.dispatchEvent(mouseEvent);
        }

        function openSignatureModal() {
            document.getElementById('signature-modal').classList.remove('hidden');
            document.getElementById('signature-modal').classList.add('flex');
        }

        function closeSignatureModal() {
            document.getElementById('signature-modal').classList.add('hidden');
            document.getElementById('signature-modal').classList.remove('flex');
            clearSignature();
            document.getElementById('signature-name').value = '';
        }

        function clearSignature() {
            signatureCtx.clearRect(0, 0, signatureCanvas.width, signatureCanvas.height);
        }

        function saveSignature() {
            const name = document.getElementById('signature-name').value.trim();
            if (!name) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„ÙÙ†ÙŠ');
                return;
            }
            
            const signatureData = signatureCanvas.toDataURL();
            MaintenanceSystem.signatures[name] = signatureData;
            MaintenanceSystem.saveData();
            
            populateSignaturesDropdowns();
            closeSignatureModal();
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­!');
        }

        // Print Functions
        function printReceptionForm() {
            const formData = getReceptionFormData();
            if (!validateReceptionForm(formData)) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                return;
            }
            
            const printContent = generateReceptionPrintContent(formData);
            document.getElementById('print-area').innerHTML = printContent;
            document.getElementById('print-area').classList.remove('hidden');
            
            setTimeout(() => {
                window.print();
                document.getElementById('print-area').classList.add('hidden');
            }, 100);
        }

        function printTaskDetails(taskId) {
            const task = MaintenanceSystem.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            const printContent = generateTaskPrintContent(task);
            document.getElementById('print-area').innerHTML = printContent;
            document.getElementById('print-area').classList.remove('hidden');
            
            setTimeout(() => {
                window.print();
                document.getElementById('print-area').classList.add('hidden');
            }, 100);
        }

        function printCompletionForm(taskId) {
            const task = MaintenanceSystem.tasks.find(t => t.id === taskId);
            if (!task) return;
            
            const printContent = generateCompletionPrintContent(task);
            document.getElementById('print-area').innerHTML = printContent;
            document.getElementById('print-area').classList.remove('hidden');
            
            setTimeout(() => {
                window.print();
                document.getElementById('print-area').classList.add('hidden');
            }, 100);
        }

        function getReceptionFormData() {
            const hasDataRadio = document.querySelector('input[name="has-data"]:checked');
            return {
                deviceType: document.getElementById('device-type').value,
                usageType: document.getElementById('usage-type').value,
                deviceModel: document.getElementById('device-model').value,
                receivingTechnician: document.getElementById('receiving-technician').value,
                receiveDateTime: document.getElementById('receive-datetime').value,
                formatType: document.getElementById('format-type').value,
                language: document.getElementById('language').value,
                hasData: hasDataRadio ? hasDataRadio.value : '',
                technicianSignature: document.getElementById('technician-signature').value,
                beneficiaryName: document.getElementById('beneficiary-name').value,
                employeeNumber: document.getElementById('employee-number').value,
                department: document.getElementById('department').value,
                locationCode: document.getElementById('location-code').value,
                contactNumber: document.getElementById('contact-number').value
            };
        }

        function validateReceptionForm(data) {
            const required = ['deviceType', 'usageType', 'deviceModel', 'receivingTechnician', 
                            'beneficiaryName', 'employeeNumber', 'department', 'locationCode', 'contactNumber'];
            return required.every(field => data[field] && data[field].trim() !== '');
        }

        function generateReceptionPrintContent(data) {
            const technician = MaintenanceSystem.technicians.find(t => t.id === data.receivingTechnician);
            const signature = MaintenanceSystem.signatures[data.technicianSignature];
            
            return `
                <div style="font-family: 'Tajawal', sans-serif; direction: rtl; padding: 40px;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h1 style="color: #B8860B; font-size: 28px; margin-bottom: 10px;">Ù†Ù…ÙˆØ°Ø¬ Ø§Ø³ØªÙ„Ø§Ù… Ø¬Ù‡Ø§Ø²</h1>
                        <h2 style="color: #556B2F; font-size: 20px;">Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª - Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ</h2>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold; width: 30%;">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getDeviceTypeText(data.deviceType)}</td>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold; width: 30%;">Ø§Ù„Ø·Ø±Ø§Ø²</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${data.deviceModel}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getUsageTypeText(data.usageType)}</td>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${new Date(data.receiveDateTime).toLocaleString('ar-SA')}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;" colspan="3">${technician ? technician.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                        </tr>
                    </table>
                    
                    <h3 style="color: #B8860B; margin-bottom: 15px;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold; width: 25%;">Ø§Ù„Ø§Ø³Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${data.beneficiaryName}</td>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold; width: 25%;">Ø±Ù‚Ù… Ø§Ù„Ù…Ù†Ø³ÙˆØ¨</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${data.employeeNumber}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ù‚Ø³Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${data.department}</td>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ù…Ù‚Ø±</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${data.locationCode}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</td>
                            <td style="border: 1px solid #ddd; padding: 12px;" colspan="3">${data.contactNumber}</td>
                        </tr>
                    </table>
                    
                    <h3 style="color: #B8860B; margin-bottom: 15px;">Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù† Ø§Ù„ÙÙ†ÙŠ</h3>
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold; width: 25%;">Ø§Ù„ÙÙˆØ±Ù…Ø§Øª</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getFormatTypeText(data.formatType)}</td>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold; width: 25%;">Ø§Ù„Ù„ØºØ©</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getLanguageText(data.language)}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</td>
                            <td style="border: 1px solid #ddd; padding: 12px;" colspan="3">${data.hasData === 'yes' ? 'ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‡Ù…Ø©' : 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'}</td>
                        </tr>
                    </table>
                    
                    <div style="margin-top: 50px;">
                        <div style="display: inline-block; width: 45%; text-align: center;">
                            <div style="border-bottom: 1px solid #000; margin-bottom: 10px; height: 60px;">
                                ${signature ? `<img src="${signature}" style="max-height: 50px;">` : ''}
                            </div>
                            <p>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</p>
                        </div>
                        <div style="display: inline-block; width: 45%; text-align: center; float: left;">
                            <div style="border-bottom: 1px solid #000; margin-bottom: 10px; height: 60px;"></div>
                            <p>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateTaskPrintContent(task) {
            const receivingTech = MaintenanceSystem.technicians.find(t => t.id === task.receivingTechnician);
            
            return `
                <div style="font-family: 'Tajawal', sans-serif; direction: rtl; padding: 40px;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h1 style="color: #B8860B; font-size: 28px; margin-bottom: 10px;">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù…Ø©</h1>
                        <h2 style="color: #556B2F; font-size: 20px;">Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h2>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getDeviceTypeText(task.deviceType)} - ${task.deviceModel}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${task.beneficiaryName} (${task.employeeNumber})</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ù‚Ø³Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${task.department}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ù…Ù‚Ø±</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${task.locationCode}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³ØªÙ„Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${receivingTech ? receivingTech.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${new Date(task.receiveDateTime).toLocaleString('ar-SA')}</td>
                        </tr>
                    </table>
                </div>
            `;
        }

        function generateCompletionPrintContent(task) {
            const receivingTech = MaintenanceSystem.technicians.find(t => t.id === task.receivingTechnician);
            const executingTech = MaintenanceSystem.technicians.find(t => t.id === task.executingTechnician);
            const signature = MaintenanceSystem.signatures[task.executionSignature];
            
            return `
                <div style="font-family: 'Tajawal', sans-serif; direction: rtl; padding: 40px;">
                    <div style="text-align: center; margin-bottom: 30px;">
                        <h1 style="color: #B8860B; font-size: 28px; margin-bottom: 10px;">Ù†Ù…ÙˆØ°Ø¬ ØªØ³Ù„ÙŠÙ… Ø¬Ù‡Ø§Ø²</h1>
                        <h2 style="color: #556B2F; font-size: 20px;">Ù‚Ø³Ù… ØªÙ‚Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</h2>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ù…Ø³ØªÙÙŠØ¯</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${task.beneficiaryName}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ù†ÙˆØ¹ Ø§Ù„Ø¬Ù‡Ø§Ø²</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getDeviceTypeText(task.deviceType)} - ${task.deviceModel}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø±Ù‚Ù… Ø§Ù„ØªÙˆØ§ØµÙ„</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${task.contactNumber}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„Ø­Ø§Ù„Ø©</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${getStatusText(task.executionStatus)}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ù†ÙØ°</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${executingTech ? executingTech.name : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #ddd; padding: 12px; background: #f9f9f9; font-weight: bold;">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…</td>
                            <td style="border: 1px solid #ddd; padding: 12px;">${new Date(task.executionDateTime).toLocaleString('ar-SA')}</td>
                        </tr>
                    </table>
                    
                    <div style="margin-top: 50px;">
                        <div style="display: inline-block; width: 45%; text-align: center;">
                            <div style="border-bottom: 1px solid #000; margin-bottom: 10px; height: 60px;">
                                ${signature ? `<img src="${signature}" style="max-height: 50px;">` : ''}
                            </div>
                            <p>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù…Ø³Ù„Ù…</p>
                        </div>
                        <div style="display: inline-block; width: 45%; text-align: center; float: left;">
                            <div style="border-bottom: 1px solid #000; margin-bottom: 10px; height: 60px;"></div>
                            <p>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Utility Functions
        function getDeviceTypeText(type) {
            const types = {
                'computer': 'Ø­Ø§Ø³Ø¨ Ø¢Ù„ÙŠ',
                'printer': 'Ø·Ø§Ø¨Ø¹Ø©',
                'scanner': 'Ù…Ø§Ø³Ø­ Ø¶ÙˆØ¦ÙŠ'
            };
            return types[type] || type;
        }

        function getUsageTypeText(type) {
            const types = {
                'private': 'Ø®Ø§Øµ',
                'lab': 'Ù…Ø¹Ù…Ù„'
            };
            return types[type] || type;
        }

        function getFormatTypeText(type) {
            const types = {
                'full': 'ÙÙˆØ±Ù…Ø§Øª ÙƒØ§Ù…Ù„',
                'quick': 'ÙÙˆØ±Ù…Ø§Øª Ø³Ø±ÙŠØ¹',
                'none': 'Ø¨Ø¯ÙˆÙ† ÙÙˆØ±Ù…Ø§Øª'
            };
            return types[type] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        function getLanguageText(lang) {
            const languages = {
                'arabic': 'Ø¹Ø±Ø¨ÙŠ',
                'english': 'Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ',
                'both': 'Ø¹Ø±Ø¨ÙŠ + Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ'
            };
            return languages[lang] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        function getStatusText(status) {
            const statuses = {
                'ready': 'Ø¬Ø§Ù‡Ø²',
                'waiting': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
                'contact': 'Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³ØªÙÙŠØ¯'
            };
            return statuses[status] || status;
        }

        function getStatusClass(status) {
            const classes = {
                'ready': 'status-ready',
                'waiting': 'status-waiting',
                'contact': 'status-contact'
            };
            return classes[status] || '';
        }

        function getDepartmentText(dept) {
            const departments = {
                'maintenance': 'Ø§Ù„ØµÙŠØ§Ù†Ø©',
                'technical-support': 'Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ',
                'network': 'Ø§Ù„Ø´Ø¨ÙƒØ§Øª',
                'systems': 'Ø§Ù„Ø£Ù†Ø¸Ù…Ø©',
                'admin': 'Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©'
            };
            return departments[dept] || dept;
        }

        function getPositionText(position) {
            const positions = {
                'technician': 'ÙÙ†ÙŠ',
                'senior-technician': 'ÙÙ†ÙŠ Ø£ÙˆÙ„',
                'supervisor': 'Ù…Ø´Ø±Ù',
                'manager': 'Ù…Ø¯ÙŠØ±'
            };
            return positions[position] || position;
        }

        function getSpecializationText(spec) {
            const specializations = {
                'hardware': 'ØµÙŠØ§Ù†Ø© Ø§Ù„Ø£Ø¬Ù‡Ø²Ø©',
                'software': 'Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª',
                'network': 'Ø§Ù„Ø´Ø¨ÙƒØ§Øª',
                'printers': 'Ø§Ù„Ø·Ø§Ø¨Ø¹Ø§Øª'
            };
            return specializations[spec] || spec;
        }

        function getPriorityText(priority) {
            const priorities = {
                'high': 'Ø¹Ø§Ù„ÙŠØ©',
                'medium': 'Ù…ØªÙˆØ³Ø·Ø©',
                'low': 'Ù…Ù†Ø®ÙØ¶Ø©'
            };
            return priorities[priority] || priority;
        }

        function getMaintenanceTypeText(type) {
            const types = {
                'preventive': 'ØµÙŠØ§Ù†Ø© ÙˆÙ‚Ø§Ø¦ÙŠØ©',
                'corrective': 'ØµÙŠØ§Ù†Ø© Ø¥ØµÙ„Ø§Ø­ÙŠØ©',
                'emergency': 'ØµÙŠØ§Ù†Ø© Ø·Ø§Ø±Ø¦Ø©',
                'upgrade': 'ØªØ±Ù‚ÙŠØ©'
            };
            return types[type] || type;
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.id === 'signature-modal') {
                closeSignatureModal();
            }
        });
    </script>
</body>
</html>
</body>
</html>
